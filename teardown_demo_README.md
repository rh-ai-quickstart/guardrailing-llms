<!-- Generated by Cursor -->

# Guardrailing LLMs Demo Teardown

This document describes how to cleanly remove the Guardrailing LLMs demo from your OpenShift cluster. For installation, see `setup_demo_README.md`.

## Quick Start

### Basic Teardown (Preserve Project)

```bash
./teardown_demo.sh
```

### Complete Teardown (Delete Project)

```bash
./teardown_demo.sh --delete-project
```

### Force Teardown (No Confirmation)

```bash
./teardown_demo.sh -f --delete-project
```

## What Gets Removed

The teardown script removes the following resources in order:

1. **Helm Release**: `guardrailing-llms`
2. **InferenceServices**:
   - `gibberish-detector`
   - `prompt-injection-detector`
   - `ibm-hate-and-profanity-detector`
   - `llama-32-3b-instruct`
3. **Kubernetes Resources**:
   - Routes
   - Services
   - Deployments
   - StatefulSets
   - Jobs
   - Horizontal Pod Autoscalers
   - Pods
   - Persistent Volume Claims
   - ConfigMaps
   - Secrets
4. **Project** (optional): The entire OpenShift project/namespace

## Command Line Options

| Option                  | Description                         | Default           |
| ----------------------- | ----------------------------------- | ----------------- |
| `-p, --project PROJECT` | OpenShift project/namespace         | `guardrails-demo` |
| `-f, --force`           | Force deletion without confirmation | `false`           |
| `--delete-project`      | Also delete the entire project      | `false`           |
| `-h, --help`            | Show help message                   | -                 |

## Examples

### Remove from Different Project

```bash
./teardown_demo.sh -p my-custom-demo
```

### Force Delete Everything

```bash
./teardown_demo.sh -f --delete-project
```

### Interactive Teardown

```bash
./teardown_demo.sh --delete-project
# Script will ask for confirmation before proceeding
```

## Safety Features

- **Confirmation Prompt**: By default, asks for user confirmation before deletion
- **Prerequisites Check**: Verifies `oc` and `helm` are available and user is logged in
- **Graceful Cleanup**: Waits for resources to be fully deleted before proceeding
- **Error Handling**: Continues cleanup even if some resources fail to delete
- **Status Reporting**: Provides detailed feedback on what's being removed

## Troubleshooting

### Project Stuck in Terminating State

If the project gets stuck in "Terminating" state:

```bash
# Check what's preventing deletion
oc get project guardrails-demo -o yaml

# Force delete finalizers (use with caution)
oc patch project guardrails-demo -p '{"metadata":{"finalizers":null}}' --type=merge
```

### Resources Not Deleting

If some resources won't delete:

```bash
# Check for finalizers
oc get <resource-type> <resource-name> -o yaml | grep finalizers

# Remove finalizers (use with caution)
oc patch <resource-type> <resource-name> -p '{"metadata":{"finalizers":null}}' --type=merge
```

### Helm Release Issues

If Helm release won't uninstall:

```bash
# Check Helm release status
helm list -n guardrails-demo

# Force uninstall
helm uninstall guardrailing-llms -n guardrails-demo --no-hooks
```

## Manual Cleanup

If the script fails, you can manually clean up:

```bash
# Switch to the project
oc project guardrails-demo

# Remove Helm release
helm uninstall guardrailing-llms -n guardrails-demo

# Remove InferenceServices
oc delete inferenceservice --all -n guardrails-demo

# Remove all resources
oc delete all --all -n guardrails-demo

# Remove PVCs
oc delete pvc --all -n guardrails-demo

# Remove project
oc delete project guardrails-demo
```

## Verification

After teardown, verify everything is removed:

```bash
# Check if project exists
oc get project guardrails-demo

# Check for any remaining resources
oc get all -n guardrails-demo

# Check Helm releases
helm list -n guardrails-demo
```

## Support

If you encounter issues with the teardown script:

1. Check the script output for error messages
2. Verify you have the necessary permissions
3. Check if resources are stuck in terminating state
4. Try manual cleanup steps above
5. Contact your OpenShift administrator if needed
